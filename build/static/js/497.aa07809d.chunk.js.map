{"version":3,"file":"static/js/497.aa07809d.chunk.js","mappings":"oOAWA,MA8GA,EA9GiBA,KACf,MAAMC,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,OAETC,KAAMC,EAAQ,QAAEC,IAAYC,EAAAA,EAAAA,SAAgBC,GAC9CC,EAAOJ,aAAQ,EAARA,EAAUD,MAChBM,EAAQC,IAAaC,EAAAA,EAAAA,WAAS,IAC9BC,EAAMC,IAAWF,EAAAA,EAAAA,UAASH,aAAI,EAAJA,EAAMM,WAEhCC,GAAgB,UAAEC,EAAS,QAAEC,EAAO,UAAEC,KAC3CC,EAAAA,EAAAA,OAwBFC,EAAAA,EAAAA,YAAU,KAENV,IADEE,EAIJ,GACC,CAACA,IAMJ,OACES,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKC,UAAU,cACfH,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACED,EAAAA,EAAAA,MAAA,OAAKG,UAAU,6EAA4EF,SAAA,EACzFC,EAAAA,EAAAA,KAACE,EAAAA,GAAI,CAACC,GAAG,QAAQF,UAAU,cAAaF,UACtCC,EAAAA,EAAAA,KAAA,OACEI,MAAM,6BACNC,MAAM,KACNC,OAAO,KACPC,QAAQ,YACRC,KAAK,OAAMT,UAEXC,EAAAA,EAAAA,KAAA,QACES,EAAE,iGACFD,KAAK,eAIXR,EAAAA,EAAAA,KAAA,OAAKC,UAAU,sBAAqBF,SAAC,WACrCC,EAAAA,EAAAA,KAAA,OAAKC,UAAU,8BAAmC,QAGpDH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yBAAwBF,SAAA,EACrCD,EAAAA,EAAAA,MAAA,QAAMY,SA1DOC,UACnBC,EAAEC,iBACF,UACQrB,EAAe,CAAEsB,aAAczB,IAAQ0B,SAC7CjC,IACAN,GACEwC,EAAAA,EAAAA,IAAU,CACRC,QAAS,WACTC,KAAM,aAGVxC,EAAS,QACX,CAAE,MAAOyC,GAAa,IAADC,EACnB5C,GACEwC,EAAAA,EAAAA,IAAU,CACRC,SAAUE,SAAmB,QAAdC,EAALD,EAAevC,YAAI,IAAAwC,OAAd,EAANA,EAAsBC,MAAO,UACtCH,KAAM,UAGZ,GAuCoCjB,UAAU,SAAQF,SAAA,EAC9CC,EAAAA,EAAAA,KAAA,SACEkB,KAAK,OACLjB,UAAU,YACVqB,YAAY,UACZC,MAAOlC,EACPmC,SAAWZ,GAAMtB,EAAQsB,EAAEa,OAAOF,OAClCG,SAAUjC,KAEZO,EAAAA,EAAAA,KAAA,UACEC,UAAW,aACX0B,MAAO,CACLC,WAAY1C,EAAS,UAAY,4BACjC2C,MAAO3C,EAAS,QAAU,6BAC1Ba,SACH,WAIHC,EAAAA,EAAAA,KAAA,UAAQC,UAAU,kBAAkB6B,QA/CvBC,KACnBzC,EAAQ,GAAG,EA8CqDS,UACxDC,EAAAA,EAAAA,KAAA,OACEI,MAAM,6BACNC,MAAM,KACNC,OAAO,KACPC,QAAQ,YACRC,KAAK,OAAMT,UAEXC,EAAAA,EAAAA,KAAA,QACES,EAAE,0IACFD,KAAK,QACL,eAAa,oBAMnB,C","sources":["pages/profile/Username.tsx"],"sourcesContent":["import { useDispatch, useSelector } from \"react-redux\";\nimport \"./profile.css\";\nimport { useEffect, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport {\n  useChangeUsernameMutation,\n  useGetUserQuery,\n} from \"../profile/services/profileApi\"; // import the hook\nimport { setUser } from \"./components/slice/UserSlice\";\nimport { showToast } from \"./error/ErrorSlice\";\n\nconst Username = () => {\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const { data: userData, refetch } = useGetUserQuery(undefined);\n  const user = userData?.data;\n  const [active, setActive] = useState(false);\n  const [text, setText] = useState(user?.username);\n\n  const [changeUsername, { isLoading, isError, isSuccess }] =\n    useChangeUsernameMutation(); // use the mutation hook\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    try {\n      await changeUsername({ new_username: text }).unwrap();\n      refetch();\n      dispatch(\n        showToast({\n          message: \"用户名修改成功！\",\n          type: \"success\",\n        })\n      );\n      navigate(\"/info\");\n    } catch (error: any) {\n      dispatch(\n        showToast({\n          message: (error as any)?.data?.msg || \"无法更改用户名\",\n          type: \"error\",\n        })\n      );\n    }\n  };\n\n  useEffect(() => {\n    if (text) {\n      setActive(true);\n    } else {\n      setActive(false);\n    }\n  }, [text]);\n\n  const handleRemove = () => {\n    setText(\"\");\n  };\n\n  return (\n    <div>\n      <div className=\"fixed-bg\"></div>\n      <div>\n        <div className=\"flex fixed top-0 w-full z-10 bg-[#161619] justify-between items-center p-2\">\n          <Link to=\"/info\" className=\"back-button\">\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"24\"\n              height=\"24\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n            >\n              <path\n                d=\"M7.828 11H20V13H7.828L13.192 18.364L11.778 19.778L4 12L11.778 4.22198L13.192 5.63598L7.828 11Z\"\n                fill=\"white\"\n              />\n            </svg>\n          </Link>\n          <div className=\"history-title pr-10\">修改用户名</div>\n          <div className=\"edit-title cursor-pointer\"></div>{\" \"}\n          {/* Trigger form submit */}\n        </div>\n        <div className=\"mt-[80px] p-4 relative\">\n          <form onSubmit={handleSubmit} className=\"w-full\">\n            <input\n              type=\"text\"\n              className=\"new-input\"\n              placeholder=\"输入您的用户名\"\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              disabled={isLoading} // Disable input during submission\n            />\n            <button\n              className={`submit_btn`}\n              style={{\n                background: active ? \"#F54100\" : \"rgba(255, 255, 255, 0.04)\",\n                color: active ? \"white\" : \"rgba(255, 255, 255, 0.20)\",\n              }}\n            >\n              保存\n            </button>\n          </form>\n          <button className=\"close-btn-input\" onClick={handleRemove}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"10\"\n              height=\"10\"\n              viewBox=\"0 0 10 10\"\n              fill=\"none\"\n            >\n              <path\n                d=\"M5 3.88906L8.88906 0L10 1.11094L6.11094 5L10 8.88906L8.88906 10L5 6.11094L1.11094 10L0 8.88906L3.88906 5L0 1.11094L1.11094 0L5 3.88906Z\"\n                fill=\"white\"\n                fill-opacity=\"0.8\"\n              />\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Username;\n"],"names":["Username","dispatch","useDispatch","navigate","useNavigate","data","userData","refetch","useGetUserQuery","undefined","user","active","setActive","useState","text","setText","username","changeUsername","isLoading","isError","isSuccess","useChangeUsernameMutation","useEffect","_jsxs","children","_jsx","className","Link","to","xmlns","width","height","viewBox","fill","d","onSubmit","async","e","preventDefault","new_username","unwrap","showToast","message","type","error","_data","msg","placeholder","value","onChange","target","disabled","style","background","color","onClick","handleRemove"],"sourceRoot":""}